import { CurrentRestaurantProvider } from '@buffet/current-restaurant-context';
import { CurrentUserProvider } from '@buffet/current-user-context';
import { FeatureToggleProvider } from '@buffet/feature-toggle-context';
import { Touchable } from '@buffet/icon';
import { ScopeSelectorProvider, ScopeSelectorView } from '@buffet/scope-selector';
import LogoutAndRedirect from './LogoutService';

import React from 'react';
import { FormattedMessage, InjectedIntlProps, injectIntl } from 'react-intl';

type Props = InjectedIntlProps;

class ScopeContainer extends React.Component<Props> {
  public constructor(props: any) {
    super(props);
  }

  public render = () => (
    <nav className="scope-selector-container" data-qa="selectrid">
      <header className="nav-header" data-qa="selectrid--head">
        <span className="corner-spacing">
          <Touchable
            iconId="chevronLeft"
            onClick={LogoutAndRedirect}
            title={this.props.intl.formatMessage({ id: 'BackToSignIn' })}
            data-qa="selectrid--back"
          />
        </span>
        <span className="header-title" data-qa="selectrid--title">
          <FormattedMessage id="Select" data-qa="nav-header-title" />
        </span>
        <span className="corner-spacing" />
      </header>
      <FeatureToggleProvider globalToggleName="globalScopeSelectorIncludeGroups">
        <CurrentRestaurantProvider>
          <CurrentUserProvider>
            <ScopeSelectorProvider>
              <ScopeSelectorView data-qa="selectrid--body" />
            </ScopeSelectorProvider>
          </CurrentUserProvider>
        </CurrentRestaurantProvider>
      </FeatureToggleProvider>
    </nav>
  );
}

export default injectIntl(ScopeContainer);
export { ScopeContainer as PureScopeContainer };
