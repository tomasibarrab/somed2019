const execa = require('execa');

function diffFiles(a) {
  const { stdout } = execa.commandSync(`git diff --name-only ${a} ${getCurrentCommitHash()}`);

  return stdout.length > 0 ? stdout.split('\n') : [];
}

function getCurrentCommitHash() {
  return execa.commandSync('git rev-parse --verify HEAD').stdout;
}

function stage({ path }) {
  execa.commandSync(`git add ${path}`, { stdio: 'inherit' });
}

function commit({ message }) {
  execa.commandSync(`git commit -m "${message}"`, { stdio: 'inherit' });
}

function pushOriginMaster() {
  execa.commandSync('git push origin master', { stdio: 'inherit' });
}

function getStagedFiles() {
  const { stdout } = execa.commandSync(`git diff --name-only --cached`);

  return stdout.length > 0 ? stdout.split('\n') : [];
}

module.exports = {
  commit,
  diffFiles,
  getCurrentCommitHash,
  getStagedFiles,
  pushOriginMaster,
  stage,
};
