import { shallowWithIntl } from 'gca-jest-config';
import React from 'react';

import { mapDispatchToProps, mapStateToProps, PureApp as App } from './App';

describe('<App />', () => {
  let wrapper;
  const props = {
    error: false,
    history: { location: '/' },
    initializeGcScope: jest.fn(),
    loading: false,
    scopeType: 'restaurant',
  };

  beforeEach(() => {
    wrapper = shallowWithIntl(
      <App {...props} />,
    );
  });

  it('should render the same as the snapshot', () => {
    expect(wrapper).toMatchSnapshot();
  });

  it('should fetch initializeApp on componentDidMount', () => {
    wrapper.instance().componentDidMount();
    expect(props.initializeGcScope).toHaveBeenCalled();
  });
});

describe('connect functions', () => {
  it('mapStateToProps should return an object', () => {
    const props = mapStateToProps({ currentContext: { loading: false, error: false } });
    expect(typeof props).toBe('object');
  });

  it('mapDispatchToProps should be an object', () => {
    expect(typeof mapDispatchToProps).toBe('object');
  });
});
