import React from 'react';

import classNames from 'classnames';

import { ArrowIcon } from '../../../Icons/ArrowIcon';
import { CircleIcon } from '../../../Icons/CircleIcon';
import { TriangleIcon } from '../../../Icons/TriangleIcon';
import './HoverCard.scss';

const HoverCard = (props) => {
  const {
    title,
    description,
    content,
  } = props;

  const renderIcon = (icon) => {
    switch (icon.type) {
      case 'circle': return <CircleIcon {...icon} />;
      case 'triangle': return <TriangleIcon {...icon} />;
      case 'arrow': return <ArrowIcon {...icon} />;
      default: return null;
    }
  };

  const renderStats = (stat) => (
    <div
      className={classNames(
        'hovercard__stats',
        { 'hovercard__stats--negative': stat.status === 'negative' },
        { 'hovercard__stats--positive': stat.status === 'positive' },
      )}
    >
      { stat.icon && renderIcon(stat.icon)
      }
      <div className="hovercard__stats-label">{ stat.label }</div>
      { stat.compare && stat.compare.length &&
        <div className="hovercard__stats-comparison">({ stat.compare })</div>
      }
    </div>
  );

  const renderSecondaryListItem = (v, i) => (
    <li
      key={i}
      className={classNames(
        'hovercard__item',
      )}
    >
      <div className="hovercard__source">
        { v.icon &&
          <div className="hovercard__source-icon">{ renderIcon(v.icon) }</div>
        }
        <div className="hovercard__source-value">{ v.value }</div>
        <div className="hovercard__source-label">{ v.label }</div>
      </div>
    </li>
  );

  const renderListItem = (v, i) => (
    <li
      key={i}
      className={classNames(
        'hovercard__item',
        { 'hovercard__item--heading': v.type === 'heading' },
        { 'hovercard__item--grouped': v.type === 'grouped' },
      )}
    >
      <div className="hovercard__source">
        { v.icon &&
          <div className="hovercard__source-icon">{ renderIcon(v.icon) }</div>
        }
        <div className="hovercard__source-label">{ v.label }</div>
        <div className="hovercard__source-values">
          <div className="hovercard__source-value">
            { renderStats(v.value) }
          </div>
          {
            v.comparison &&
            <div className="hovercard__source-comparison">
              { renderStats(v.comparison) }
            </div>
          }
        </div>
        {
          v.secondary &&
          <div className="hovercard__secondary">
            <ul className="hovercard__content--secondary" style={v.secondary.style}>
              { v.secondary.content.map(renderSecondaryListItem) }
            </ul>
          </div>
        }
      </div>
    </li>
  );

  return (<div className="hovercard">
    <div className="hovercard__title">{ title }</div>
    <div className="hovercard__description">{ description }</div>
    { content.length > 0 &&
      <ul className="hovercard__content">
        { content.map(renderListItem) }
      </ul>
    }
  </div>);
};

HoverCard.defaultProps = {
  content: [],
};

export default HoverCard;
