import { mount } from 'enzyme';
import React from 'react';
import { IntlProvider } from 'react-intl';
import { Provider } from 'react-redux';
import { MemoryRouter } from 'react-router';
import configureMockStore from 'redux-mock-store';

import { keys } from '../../translations/bundles/marketing.json';
import Insights from './Insights';

jest.mock('../../PrivateDining/PrivateDining', () => () => 'MockPrivateDining');
jest.mock('./InsightsFilter', () => ({
  InsightsFilter: () => 'MockInsightsFilter',
}));
jest.mock('./InsightsSummary', () => () => 'MockInsightsSummary');
jest.mock('./InsightsTable', () => () => 'MockInsightsTable');
jest.mock('./common/DateRange/DateRange', () => () => 'MockDateRange');
jest.mock('./InsightsCoversOverTimeGraph', () => () => 'MockInsightsCoversOverTimeGraph');

describe('<Insights />', () => {
  it('should match snapshot', () => {
    const store = configureMockStore([])({
      insights: {
        campaigns: {
          data: [],
          loading: false,
        },
        coverTrends: {
          error: false,
          loading: false,
        },
        filters: {
          compareTo: 'last-year',
        },
        summaryCurrent: {
          data: undefined,
          loading: false,
        },
        summaryPrevious: {
          data: undefined,
          loading: false,
        },
      },
    });

    const wrapper = mount(
      <Provider store={store}>
        <IntlProvider locale="en" messages={keys}>
          <MemoryRouter>
            <Insights />
          </MemoryRouter>
        </IntlProvider>
      </Provider>,
    );

    expect(wrapper.debug()).toMatchSnapshot();
  });
});
