import React from 'react';
import { IntlProvider } from 'react-intl';
import { create } from 'react-test-renderer';

import { keys } from '../../../translations/bundles/marketing.json';
import CoverPrice from './CoverPrice';

const createComponent = (props: any) =>
  create(
    <IntlProvider locale="en-US" messages={keys}>
      <CoverPrice {...props} />
    </IntlProvider>,
  );

describe('CoverPrice', () => {
  const scenarios = [
    {
      description: 'campaign w/ maxBid and pricingTier (should show 3.00, not 0.01)',
      props: {
        maxBid: 3.0,
        pricingTier: { currencyCode: 'USD', price: 0.01 },
      },
    },
    {
      description: 'campaign w/o maxBid, only pricingTier',
      props: {
        pricingTier: { currencyCode: 'USD', price: 3.5 },
      },
    },
    {
      description: 'campaign w/ currencyCode we don\'t know about and defaults to "$"',
      props: {
        maxBid: 2.0,
        pricingTier: { currencyCode: 'RMB' },
      },
    },
  ];

  const commonProps = {
    messageIdSuffix: 'cover_price',
  };

  scenarios.forEach(({ props, description }) => {
    it(`renders ${description}`, () => {
      const component = createComponent({ ...commonProps, ...props });

      expect(component.toJSON()).toMatchSnapshot();
    });
  });
});
