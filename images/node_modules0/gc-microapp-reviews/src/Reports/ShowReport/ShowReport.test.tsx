import { shallowWithIntl } from 'gca-jest-config';
import React from 'react';
import { PureShowReport as ShowReport } from './ShowReport';

describe('<ShowReport />', () => {
  let wrapper;
  let props;
  beforeEach(() => {
    props = {
      deleteReport: jest.fn(),
      editReportActiveUpdate: jest.fn(),
      report: {
        Frequency: 'Monthly',
        Recipients: ['foo@bar.com'],
        ReportId: 'testId',
        RestaurantIds: [123],
        Type: 'Detailed',
      },
      reportId: 'testId',
    };

    wrapper = shallowWithIntl(<ShowReport {...props} />);
  });

  it('should render a report item ', () => {
    expect(wrapper).toMatchSnapshot();
  });

  it('should render a report item ', () => {
    wrapper.find('button').forEach(buttonWrapper => {
      buttonWrapper.simulate('click');
    });
    expect(props.editReportActiveUpdate).toHaveBeenCalledWith(props.reportId);
    expect(props.deleteReport).toHaveBeenCalledWith({ reportId: props.reportId });
  });

  it('should correctly call click handlers', () => {
    props = {
      deleteReport: jest.fn(),
      editReportActiveUpdate: jest.fn(),
      report: {
        Frequency: 'Monthly',
        Recipients: ['foo@bar.com'],
        ReportId: 'testId',
        RestaurantIds: [123, 345],
        Type: 'Detailed',
      },
      reportId: 'testId',
    };

    wrapper = shallowWithIntl(<ShowReport {...props} />);
    wrapper.find('button').forEach(buttonWrapper => {
      buttonWrapper.simulate('click');
    });

    expect(props.deleteReport).toHaveBeenCalledWith({ reportId: props.reportId });
  });
});
