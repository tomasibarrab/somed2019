{"version":3,"sources":["../../src/services/SmartlingUploadService.js"],"names":["module","exports","SmartlingBaseService","HTTPService","HTTPLogging","SmartlingConstants","Utils","Promise","SmartlingUploadService","send","options","promiseQueue","validateOptions","bind","makeRequest","resolve","reject","accessToken","projectId","fileUri","content","contentType","post","getRequestUrl","set","plugin","appendFile","Buffer","filename","promiseBody","then","validateResponse","baseUrl","queryString","fileType","host"],"mappings":"q3BAAAA,OAAOC,OAAP,GAAiB,UAAUC,oBAAV,EAAgCC,WAAhC,EAA6CC,WAA7C,EAA0DC,kBAA1D,EAA8EC,KAA9E,EAAqFC,OAArF,EAA8F;AACvGC,wBADuG;AAEpGC,QAFoG,iBAE/FC,OAF+F,EAEtF;AACnB,aAAO,IAAIF,sBAAJ,GAA6BC,IAA7B,CAAkCC,OAAlC,CAAP;AACD,KAJ0G;;AAM3GD,QAN2G,iBAMtGC,OANsG,EAM7F;AACZ,WAAKA,OAAL,GAAeA,OAAf;;AAEA,aAAOJ,MAAMK,YAAN,CAAmB;AACxB,WAAKC,eAAL,CAAqBC,IAArB,CAA0B,IAA1B,CADwB;AAExB,WAAKC,WAAL,CAAiBD,IAAjB,CAAsB,IAAtB,CAFwB,CAAnB,CAAP;;AAID,KAb0G;;AAe3GD,mBAf2G,8BAezF;AAChB,aAAO,IAAIL,OAAJ,CAAY,UAACQ,OAAD,EAAUC,MAAV,EAAqB;AACtC,YAAMN,UAAU,OAAKA,OAArB;;AAEA,YAAI,CAACA,QAAQO,WAAb,EAA0B;AACxBD,iBAAO,wDAAP;AACD;;AAED,YAAI,CAACN,QAAQQ,SAAb,EAAwB;AACtBF,iBAAO,sDAAP;AACD;;AAED,YAAI,CAACN,QAAQS,OAAb,EAAsB;AACpBH,iBAAO,oDAAP;AACD;;AAED,YAAI,CAACN,QAAQU,OAAb,EAAsB;AACpBJ,iBAAO,oDAAP;AACD;;AAED,YAAI,CAACN,QAAQW,WAAb,EAA0B;AACxBL,iBAAO,wDAAP;AACD;;AAEDD,gBAAQL,OAAR;AACD,OAxBM,CAAP;AAyBD,KAzC0G;;AA2C3GI,eA3C2G,wBA2C/FJ,OA3C+F,EA2CtF;AACnB,aAAOP,YAAYmB,IAAZ,CAAiB,KAAKC,aAAL,CAAmBb,OAAnB,CAAjB;AACJc,SADI,CACA,eADA,cAC2Bd,QAAQO,WADnC;AAEJQ,YAFI,CAEGrB,WAFH;AAGJsB,gBAHI,CAGO,MAHP,EAGe,IAAIC,MAAJ,CAAWjB,QAAQU,OAAnB,CAHf,EAG4C;AAC/CQ,kBAAUlB,QAAQS,OAD6B;AAE/CE,qBAAaX,QAAQW,WAF0B,EAH5C;;AAOJQ,iBAPI;AAQJC,UARI,CAQC,KAAKC,gBARN,CAAP;AASD,KArD0G;;AAuD3GR,iBAvD2G,0BAuD7Fb,OAvD6F,EAuDpF;AACrB,UAAMsB,sCAAoCtB,QAAQQ,SAA5C,UAAN;AACA,UAAMe,4BAA0BvB,QAAQS,OAAlC,kBAAsDT,QAAQwB,QAApE;AACA,kBAAU7B,mBAAmB8B,IAA7B,GAAoCH,OAApC,GAA8CC,WAA9C;AACD,KA3D0G,iCACxE/B,oBADwE;;;AA8D7G,SAAOM,sBAAP;AACD,CA/DD","file":"SmartlingUploadService.js","sourcesContent":["module.exports = function (SmartlingBaseService, HTTPService, HTTPLogging, SmartlingConstants, Utils, Promise) {\n  class SmartlingUploadService extends SmartlingBaseService {\n    static send(options) {\n      return new SmartlingUploadService().send(options);\n    }\n\n    send(options) {\n      this.options = options;\n\n      return Utils.promiseQueue([\n        this.validateOptions.bind(this),\n        this.makeRequest.bind(this)\n      ]);\n    }\n\n    validateOptions() {\n      return new Promise((resolve, reject) => {\n        const options = this.options;\n\n        if (!options.accessToken) {\n          reject('Invalid Smartling Upload Option accessToken is missing');\n        }\n\n        if (!options.projectId) {\n          reject('Invalid Smartling Upload Option projectId is missing');\n        }\n\n        if (!options.fileUri) {\n          reject('Invalid Smartling Upload Option fileUri is missing');\n        }\n\n        if (!options.content) {\n          reject('Invalid Smartling Upload Option content is missing');\n        }\n\n        if (!options.contentType) {\n          reject('Invalid Smartling Upload Option contentType is missing');\n        }\n\n        resolve(options);\n      });\n    }\n\n    makeRequest(options) {\n      return HTTPService.post(this.getRequestUrl(options))\n        .set('Authorization', `Bearer ${options.accessToken}`)\n        .plugin(HTTPLogging)\n        .appendFile('file', new Buffer(options.content), {\n          filename: options.fileUri,\n          contentType: options.contentType\n        })\n        .promiseBody()\n        .then(this.validateResponse);\n    }\n\n    getRequestUrl(options) {\n      const baseUrl = `/files-api/v2/projects/${options.projectId}/file`;\n      const queryString = `?fileUri=${options.fileUri}&fileType=${options.fileType}`;\n      return `${SmartlingConstants.host}${baseUrl}${queryString}`;\n    }\n  }\n\n  return SmartlingUploadService;\n};\n"]}