<!DOCTYPE html>
<html lang="<%= microapp.lang %>">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  {{#if isResponsive}}
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
  {{else}}
  <meta name="viewport" content="width=device-width">
  <meta name="msapplication-config" content="none">
  {{/if}}
  <title><%- microapp.title %></title>

  <link rel="stylesheet" href="<%= microapp.cdnPath %>main.css">
  <script>
    window.hydronator = <%- hydronator %>
    <% if (typeof gcaConfig != 'undefined') { %>
    window.gcaConfig = <%- gcaConfig %>
    <% } %>
    <% if (typeof groupSettingsConfig != 'undefined') { %>
    window.groupSettingsConfig = <%- groupSettingsConfig %>
    <% } %>
    window.gcScope = <%- gcScope %>
    window.chromeProps = {{{chromeProps}}}
  </script>
  {{#if withChrome}}
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/6.26.0/polyfill.min.js"></script>
  <script src="<%= microapp.buffetBundleVendorWebJs %>"></script>
  <script src="<%= microapp.buffetBundleChromeWebJs %>"></script>
  {{/if}}

  <% if (locals.GCAMixpanel) { %>
    <%- GCAMixpanel %>
  <% } %>

  <link rel="shortcut icon" href="/Content/img/icons/favicon.ico?v=<%= buildVersion%>" type="image/x-icon">
  <link rel="apple-touch-icon-precomposed" sizes="60x60" href="/Content/img/icons/apple-touch-icon-60x60.png?v=<%= buildVersion%>">
  <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/Content/img/icons/apple-touch-icon-76x76.png?v=<%= buildVersion%>">
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/Content/img/icons/apple-touch-icon-120x120.png?v=<%= buildVersion%>">
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/Content/img/icons/apple-touch-icon-152x152.png?v=<%= buildVersion%>">
</head>

<body>
  {{#if withChrome}}
  <div id="chrome"></div>
  {{/if}}
  <div id="app"></div>

  <script data-dll="true" type="text/javascript" src="<%= microapp.vendorPath %>{{dllVersion}}/gcaCommon.dll.prod.js"></script>
  <script type="text/javascript" src="<%= microapp.cdnPath %>main.js"></script>

  <% if (locals.googleAnalytics) { %>
  <!-- Google Tag Manager -->
  <script>
    const GTM = <%- JSON.stringify(googleAnalytics) %>;
    window.dataLayer = window.dataLayer || [];
    dataLayer.push({
      gcScope: window.gcScope
    });
    if(GTM.Enabled) {
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
        var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
        j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer', GTM.Account);
      const NOSCRIPT_LINK = "https://www.googletagmanager.com/ns.html?id=" + GTM.Account;
      window.onLoad = function() {
        document.getElementByID('gtm-iframe').src = NOSCRIPT_LINK;
      }
    }
  </script>
  <!-- End Google Tag Manager -->
  <!-- Google Tag Manager (noscript) -->
  <noscript>
    <iframe id="gtm-iframe" src="" height="0" width="0" style="display:none;visibility:hidden"></iframe>
  </noscript>
  <!-- End Google Tag Manager (noscript) -->
  <% } %>
</body>
</html>
