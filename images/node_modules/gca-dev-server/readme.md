# Dev-Server

This server serves your microapp and automatically watches your `src` directory for changes.

It accepts the following parameters:

* -p --port <port-number>  (by default: 3000)
* --path <root-path> (by default: '/' )
* TEMPLATE_PATH as an environment variable - an ejs template, relative to the
  current working directory which will be used instead of the default ejs
  template.

For example:

```
  $ npx dev-server --port 9900 --path /styleguide
```

Not that the path must start with a `/`.

## Micro App configuration

By default the dev-server will use `app.config.js` in the app directory to read some basic configurations to be used while building.

You can set your own configuration file by using the `--config` option:

```
yarn task start --config myconfig.js
```

## Mocks

You can define simple mocked responses for some routes by writing a `mocks.json` file in the main directory of your microapp.

For example:

```json
{
  "/admin/api/restaurant/:rid/v2/users": {
    "verb": "GET",
    "file": "./fixtures/users.json"
  },
  "/gateway/proxies/gcBohApi/api/restaurant/:rid/featureToggles": {
    "verb": "GET",
    "data": {
      "rebrandingFonts": "true",
      "navigationRedesign": "true",
      "gcaProfilePhotos": "true",
      "gcaProfileMenus": "true",
      "gcaBillingMakePayment": "true",
      "gcaBillingAccountBalance": "true",
      "gcaMarketingPromos": "true",
      "featureAlternateSearchNames": "true",
      "featureRolesAndPermissions": "true"
    }
  }
}
```

If you want to run the **dev-server** without the mocks add the `--nomocks` argument:

```bash
yarn task start --nomocks
```

## Static mode

Finally, you can run the dev-server as a fully static server, where there will be no processing of the `index.html` template file of your microapp.

```bash
yarn task start --static
```

This mode is useful if you are testing your microsite code and browsing the microapp through the microsite.

```
Browser              MicroSite                   dev-server
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 localhost:9000/ ------> *                           .
                         |                           .
                         +--- localhost:3000 ------> *
                         .                           |
                         .                           |
                         + <----- index.html <-------+
                         |
               <template-processing>
                         |
 <response> <------------+

```

