// Important modules this config uses
const { join } = require('path');
const path = require('path');
const webpack = require('webpack');
const pkg = require(join(process.cwd(), 'package.json'));
const outputPath = join(process.cwd(), 'dist');

process.env.NODE_ENV = 'production';

module.exports = require('./webpack.base')({
  mode: 'production',
  entry: Object.keys(pkg.dependencies).filter(dep => !dep.includes('@types')),
  output: {
    filename: 'gcaCommon.dll.prod.js',
    path: outputPath,
    library: 'gcaCommon',
  },
  plugins: [new webpack.DllPlugin({ name: 'gcaCommon', path: join(outputPath, 'gcaCommon.prod.json') })],
});
