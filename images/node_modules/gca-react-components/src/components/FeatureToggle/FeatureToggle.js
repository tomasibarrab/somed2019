import PropTypes from 'prop-types';
import { connect } from 'react-redux';
import safeGet from '../../utils/safeGet';

export function PureFeatureToggle({ featureId, features, children, hide }) {
  if (hide) {
    return features[featureId] ? null : children;
  }
  return features[featureId] ? children : null;
}

PureFeatureToggle.defaultProps = {
  hide: false,
};

PureFeatureToggle.propTypes = {
  featureId: PropTypes.string.isRequired,
  features: PropTypes.objectOf(PropTypes.bool),
  hide: PropTypes.bool,
};

function mapStateToProps(state) {
  return {
    initialFetch: safeGet(state, ['featureToggles', 'initialFetch']),
    features: safeGet(state, ['featureToggles', 'features']),
  };
}

export const FeatureToggle = connect(mapStateToProps)(PureFeatureToggle);
