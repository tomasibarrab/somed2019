import { shallow } from 'enzyme';
import React from 'react';

import { TextArea } from './TextArea';

const baseProps = {
  onChange: jest.fn(),
  valid: true,
  value: '',
};

/* eslint-disable max-len */
const longValue =
  'While modernist critical theory (as described above) concerns itself with "forms of authority and injustice that accompanied the evolution of industrial and corporate capitalism as a political-economic system," postmodern critical theory politicizes social problems "by situating them in historical and cultural contexts, to implicate themselves in the process of collecting and analyzing data, and to relativize their findings". Meaning itself is seen as unstable due to the rapid transformation in social structures. As a result, the focus of research is centered on local manifestations, rather than broad generalizations.';

describe('<TextArea />', () => {
  const propSets = {
    basic: {},
    className: { className: 'my-extra-class' },
    full: { value: longValue },
    invalid: { valid: false },
    'invalid className': { className: 'my-extra-class', valid: false },
    max: { max: 100 },
    minWithoutFormatter: { min: 100 },
    minWithFormatter: {
      min: 100,
      labels: { minimum: 'Label for minimum characters' },
      formatLabel: text => text,
    },
    'pass-through': {
      name: 'criticalTheoryDescription',
      placeholder: 'Tell us a little about the difference between modern and postmodern critical theory...',
      rows: 10,
    },
    hideLabels: {
      showLabels: false,
    },
  };

  Object.keys(propSets).forEach(key => {
    it(`${key} snapshot`, () => {
      expect(shallow(<TextArea {...baseProps} {...propSets[key]} />)).toMatchSnapshot();
    });
  });

  it('onChange handler', () => {
    const wrapper = shallow(<TextArea {...baseProps} />);
    const value = 'My new value';
    wrapper.find('textarea').simulate('change', { target: { value } });

    expect(baseProps.onChange).toBeCalledWith(value);
  });
});
