import * as React from 'react';
import { customFinalField } from './customfield';
import * as moment from 'moment';
import { DateRangePickerShape } from 'react-dates'

import DateRangePicker from '../components/DateRangePicker/DateRangePicker';

/**
 * Since the DateRangePicker just wrap the airbnb react-dates control
 * we set the Field required props here to allow not to set initial dates
 * and manage the single value props from the Field.
 */
type DateRangePickerFieldProps = Partial<DateRangePickerShape>;

export const DateRangePickerFinalField = customFinalField<DateRangePickerFieldProps>(
  (  props, { input } ) => {
    return (
      <DateRangePicker
        startDate={input.value ? input.value.startDate : moment()}
        endDate={input.value ? input.value.endDate : moment().add(1, 'w')}
        focusedInput={input.value ? input.value.focused : 'startDate'}
        onDatesChange={(d) => {
          input.onChange({...d, focused: input.value.focused });
        }}
        onFocusChange={(f) => {
          input.onChange({...input.value, focused: f });
        } }
        isOutsideRange={(d) => false}
      />
    );
  }
);

/** @component */
export default DateRangePickerFinalField;