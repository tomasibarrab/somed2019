module.exports = ($injector, _) ->

  writers = $injector.getRegex(/Writer$/)

  class WriterStream

    @run: (manifest, result) ->
      (new WriterStream(manifest, result)).run()

    constructor: (@manifest, @result) ->

    run: ->
      @runWriters()

    runWriters: ->
      _.map @manifest.writers, (writer) =>
        (new writers[writer.name](@result.locale, @result.localeContents, writer.config)).run()
