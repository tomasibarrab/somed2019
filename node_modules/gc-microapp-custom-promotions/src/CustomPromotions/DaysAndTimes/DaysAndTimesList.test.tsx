import { mount, MountRendererProps } from 'enzyme';
import React from 'react';
import { IntlProvider } from 'react-intl';
import messages from '../../i18n/custom-promotions';
import DaysAndTimesList from './DaysAndTimesList';

jest.mock('./DayAndTimes', () => () => 'DayAndTimes');

const renderComponent = (fn: any, props: any, options?: MountRendererProps) =>
  fn(
    <IntlProvider locale="en-US" messages={messages}>
      <DaysAndTimesList {...props} />
    </IntlProvider>,
  );

describe('<DaysAndTimesList />', () => {
  test('monday isOpen by default', () => {
    const wrapper = renderComponent(mount, {});

    const monday = wrapper.find('[label="Monday"]');
    expect(monday.props().expanded).toEqual(true);

    const wednesday = wrapper.find('[label="Wednesday"]');
    expect(wednesday.props().expanded).toEqual(false);
  });

  test('click to open day', () => {
    const wrapper = renderComponent(mount, {});

    let tuesday = wrapper.find('[label="Tuesday"]');

    const tuesdayProps = tuesday.props();
    expect(tuesdayProps.expanded).toEqual(false);

    tuesdayProps.onClickDay(true /* open */);

    wrapper.update();

    tuesday = wrapper.find('[label="Tuesday"]');
    expect(tuesday.props().expanded).toEqual(true);
  });
});
