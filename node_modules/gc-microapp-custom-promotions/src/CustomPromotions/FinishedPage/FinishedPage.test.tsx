import { mount } from 'enzyme';
import React from 'react';
import { IntlProvider } from 'react-intl';
import { Provider } from 'react-redux';
import configureMockStore from 'redux-mock-store';
import messages from '../../i18n/custom-promotions';
import FinishedPage from './FinishedPage';

describe('<FinishedPage />', () => {
  const formValues = {
    blockedDays: {
      custom: {
        '2018-01-05': true,
      },
      default: {
        mothers_day_us: true,
      },
    },
    daysAndTimes: {
      tuesday: {
        midDay: true,
      },
    },
    monthlyBudget: {
      cap: 275,
    },
    seatingDates: {
      startDate: '2017-01-01',
    },
  };

  const state = {
    currentContext: {
      restaurant: { rid: '268852', name: 'Ye Olde Test Restaurant' },
      user: { userName: 'jest@example.com' },
    },
    customPromotions: {
      create: {
        formValuesSnapshot: formValues,
      },
      credits: {
        model: { currencySymbol: '$' },
      },
    },
  };

  const store = configureMockStore([])(state);

  it('renders the finished page', () => {
    const wrapper = mount(
      <IntlProvider messages={messages} locale="en-US">
        <Provider store={store}>
          <FinishedPage />
        </Provider>
      </IntlProvider>,
    );

    expect(wrapper.debug()).toMatchSnapshot();
  });
});
