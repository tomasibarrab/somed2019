import { createMixpanelMiddleware } from 'gca-react-components';
import {
  eventNames,
} from 'gca-react-components/src/redux-modules/mixpanel';
import { actions } from './customPromotions/customPromotions';
import { State } from './types';

const APP_NAME = 'CustomPromotions';

const addCommonPIProps = (state: State, props: any) => ({
  ...state.restaurantPIProperties.data,
  ...props,
});

const trackedActions = {
  [actions.clickOrInteract.type]: {
    event: eventNames.CUSTOM_ACTION,
    props: (state: State, action: any): any =>
      addCommonPIProps(state, {
        action: action.payload.action,
        feature: 'Start new campaign',
        ...action.payload.props,
      }),
  },
};

export default createMixpanelMiddleware({
  defaultProps: { app: APP_NAME },
  trackedActions,
});
