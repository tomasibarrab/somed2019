import map from 'lodash/map';
import React from 'react';
import { FormattedMessage, FormattedNumber } from 'react-intl';
import './Breakdown.scss';

import { Ratings } from '../../../store/reviewSummary/reviewSummary';

const noiseMap: { [rating: number]: string } = {
  1: 'quiet',
  2: 'moderate',
  3: 'energetic',
};

interface Props {
  ratings: Ratings;
}

function Breakdown(props: Props) {
  const rows = ['food', 'service', 'ambience', 'value', 'noise'].map(rating => {
    const value = props.ratings[rating];
    const noiseLevel = noiseMap[Math.round(value)];

    const valueComp =
      rating === 'noise' ? (
        <FormattedMessage tagName="p" id={`reviews.summary.ratingLabels.noise.${noiseLevel}`} />
      ) : (
        <FormattedNumber value={value} maximumSignificantDigits={1} minimumSignificantDigits={1} />
      );

    return (
      <tr key={rating}>
        <td className="rating">
          <FormattedMessage tagName="p" id={`reviews.summary.ratingLabels.${rating}`} />
        </td>
        <td className="value">{valueComp}</td>
      </tr>
    );
  });

  return (
    <section className="summary-rating-breakdown">
      <table>
        <tbody>{rows}</tbody>
      </table>
    </section>
  );
}

export default Breakdown;
