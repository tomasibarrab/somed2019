import { mountWithIntl, shallowWithIntl } from 'gca-jest-config';
import * as React from 'react';
// import configureMockStore from 'redux-mock-store';

import { PureManageRoles } from './ManageRoles';

describe('<ManageRoles />', () => {

  // const mockStore = configureMockStore();
  const basicProps = {
    inProgress: {},
    permissions: [],
    roles: [],
    status: 'view',
  };

  it('should render the basic as the snapshot', () => {
    const wrapper = shallowWithIntl(<PureManageRoles {...basicProps} />);
    expect(wrapper).toMatchSnapshot();
  });

  // Skipping for now. Cannot figure-out how to test the connected component actions
  // maybe we should use the pure component and connect it manually ?
  it('should call fetchPermissions, fetchRoles and fetchDefaultPermissions when mounted ', (done) => {
    const ensurePermissions = jest.fn();
    const editRole = jest.fn();

    mountWithIntl(<PureManageRoles
      inProgress={{}}
      ensurePermissions={ensurePermissions}
      editRole={editRole}
      editPermissionInRole={jest.fn}
      saveRole={jest.fn}
    />);

    setTimeout(() => {
      expect(ensurePermissions).toHaveBeenCalled();
      done();
    }, 0);
  });

});
