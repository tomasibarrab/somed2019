import agent from "superagent";

const LOGOUT_URL = "/gateway/api/account/logoff";

const handleError = (err: Error) => {
  // tslint:disable-next-line:no-console
  console.log("Unable to log out.", err);
};

const redirectToUrl = (redirectUrl: string) => {
  window.location.href = redirectUrl;
};

const LogoutAndRedirect = () => {
  agent.post(LOGOUT_URL)
  .send({})
  .end((err, res) => {
    const data = res.body;
    if (err || !data || data.resultStatus !== 2) {
      handleError(err);
    } else {
      redirectToUrl(data.redirectUrl);
    }
  })
};

export default LogoutAndRedirect;
