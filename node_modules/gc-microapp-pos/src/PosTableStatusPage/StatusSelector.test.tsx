import { DropdownSelect } from '@buffet/select';
import React from 'react';

import { shallow } from 'enzyme';

import { Props, PureStatusSelector as StatusSelector } from './StatusSelector';

describe('<StatusSelector />', () => {
  const setup = () => {
    const props: Props = {
      categoriesCheckedCount: 1,
      clearCategorySelection: jest.fn(),
      intl: { formatMessage: jest.fn().mockReturnValue('Assign Status') } as any,
      onStatusSelect: jest.fn(),
      selectedStatus: 1,
      statusListOptions: [],
    };

    const statusSelector = shallow(<StatusSelector {...props} />);
    return { props, statusSelector };
  };
  it('should exist', () => {
    const { statusSelector } = setup();

    expect(statusSelector).toBeDefined();
  });
  it('clear category selection when clicked', () => {
    const { statusSelector, props } = setup();
    expect(statusSelector.find('.clear-selection').props().onClick).toBe(props.clearCategorySelection);
  });

  it('should display status selector', () => {
    const { statusSelector, props } = setup();
    // testing select
    const selectProps = statusSelector.find(DropdownSelect).props();
    expect(selectProps.placeholder).toEqual('Assign Status');
    expect(selectProps.options).toStrictEqual(props.statusListOptions);
    selectProps.onChange({ id: 1 } as any);
    expect(props.onStatusSelect).toHaveBeenCalledWith({ id: 1 });
  });
});
