import { shallow } from 'enzyme';
import React from 'react';
import { InputFinalField, SelectFinalField } from 'shared-react-atomic-ui/finalform-fields';
import { Props, PureAlohaHaspKey as AlohaHaspKey } from './AlohaHaspKey';
import { alohaResellerOptions } from './alohaReseller.const';

describe('<AlohaHaspKey />', () => {
  const setup = (override = {}) => {
    const props: Props = {
      handleSubmit: jest.fn(),
      intl: { formatMessage: jest.fn(({ id }) => id) } as any,
    } as any;

    const alohaHaspKey = shallow(<AlohaHaspKey {...props} />);

    return { alohaHaspKey, props };
  };
  it('should have an input and hasp key form', () => {
    const { alohaHaspKey, props } = setup();

    const form = alohaHaspKey.find('form');

    expect(form.length).toBe(1);
    expect(form.props().onSubmit).toBe(props.handleSubmit);

    expect(alohaHaspKey.find(InputFinalField).length).toBe(1);
  });

  it('should have a select with all the aloha resellers and an options for no reseller and other', () => {
    const { alohaHaspKey } = setup();

    const select = alohaHaspKey.find(SelectFinalField);

    expect(select.length).toBe(1);
    expect(select.props().options).toEqual([
      { value: '', label: 'nextSteps.aloha.reseller.noReseller' },
      ...alohaResellerOptions,
      { value: 'Unknown', label: 'nextSteps.aloha.reseller.other' },
    ]);
  });
});
