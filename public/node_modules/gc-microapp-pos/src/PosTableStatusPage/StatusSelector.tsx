import { Button } from '@buffet/button';
import { DropdownSelect } from '@buffet/select';
import React from 'react';
import { InjectedIntlProps, injectIntl } from 'react-intl';
import { CategoryStatus, CategoryStatusOption } from '../store/types';

interface StateProps {
  categoriesCheckedCount: number;
  statusListOptions: CategoryStatusOption[];
  selectedStatus: number;
}
interface DispatchProps {
  clearCategorySelection: () => void;
  onStatusSelect: (status: CategoryStatusOption) => void;
}

export type Props = DispatchProps & StateProps & InjectedIntlProps;

class StatusSelector extends React.Component<Props, {}> {
  public render() {
    const { formatMessage } = this.props.intl;
    const formattedStatusListOptions = this.props.statusListOptions.map((categoryStatus: CategoryStatus) => {
      return {
        ...categoryStatus,
        label: formatMessage({ id: `tableStatus.dropDownStatuses.${categoryStatus.status}` }),
      };
    });
    return (
      <div className="status-selector-panel">
        <div className="selected-count">
          <div className="count">{this.props.categoriesCheckedCount}</div>
          <div className="count-label">{formatMessage({ id: 'tableStatus.categoriesSelected' })}</div>
        </div>

        <Button
          htmltype="button"
          type="button"
          className="clear-selection"
          onClick={this.props.clearCategorySelection}
          theme="link"
        >
          {formatMessage({ id: 'tablestatus.clearSelection' })}
        </Button>
        <DropdownSelect
          placeholder={formatMessage({ id: 'tablestatus.assignStatus' })}
          options={formattedStatusListOptions}
          onChange={this.props.onStatusSelect}
        />
      </div>
    );
  }
}

export default injectIntl(StatusSelector);
export { StatusSelector as PureStatusSelector };
