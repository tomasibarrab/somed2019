{"version":3,"sources":["../../src/client/SmartlingClient.js"],"names":["module","exports","SmartlingAuthenticateService","SmartlingDownloadOptions","SmartlingDownloadService","SmartlingProcessDownloadResponse","SmartlingUploadOptions","SmartlingUploadService","SmartlingImportService","SmartlingImportOptions","SmartlingClient","userIdentifier","userSecret","projectId","accessToken","authenticate","fetch","then","response","download","options","criteria","fileUri","localeIds","fileNameMode","localeMode","retrievalType","_setAccessToken","bind","downloadBuffer","process","saveTo","upload","fileType","content","contentType","send","import","localeId","overwrite","translationState","authenticateResponse"],"mappings":"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","file":"SmartlingClient.js","sourcesContent":["module.exports = function (SmartlingAuthenticateService,\n  SmartlingDownloadOptions, SmartlingDownloadService, SmartlingProcessDownloadResponse,\n  SmartlingUploadOptions, SmartlingUploadService,\n  SmartlingImportService, SmartlingImportOptions) {\n  class SmartlingClient {\n    constructor(userIdentifier, userSecret, projectId) {\n      this.userIdentifier = userIdentifier;\n      this.userSecret = userSecret;\n      this.projectId = projectId;\n      this.accessToken = null;\n    }\n\n    authenticate() {\n      return SmartlingAuthenticateService.fetch(this.userIdentifier, this.userSecret)\n        .then((response) => {\n          this.accessToken = response.accessToken;\n          return response;\n        });\n    }\n\n    download(options) {\n      const criteria = new SmartlingDownloadOptions({\n        projectId: this.projectId,\n        fileUri: options.fileUri,\n        localeIds: options.localeIds,\n        fileNameMode: options.fileNameMode,\n        localeMode: options.localeMode,\n        retrievalType: options.retrievalType\n      });\n\n      return this.authenticate()\n        .then(this._setAccessToken.bind(this))\n        .then(() => {\n          criteria.accessToken = this.accessToken;\n\n          return SmartlingDownloadService.fetch(criteria)\n            .then((downloadBuffer) => { // eslint-disable-line\n              return SmartlingProcessDownloadResponse.process(downloadBuffer, criteria, options.saveTo);\n            });\n        });\n    }\n\n    upload(options) {\n      const criteria = new SmartlingUploadOptions({\n        projectId: this.projectId,\n        fileUri: options.fileUri,\n        fileType: options.fileType,\n        content: options.content,\n        contentType: options.contentType\n      });\n\n      return this.authenticate()\n        .then(this._setAccessToken.bind(this))\n        .then(() => {\n          criteria.accessToken = this.accessToken;\n\n          return SmartlingUploadService.send(criteria);\n        });\n    }\n\n    import(options) {\n      const criteria = new SmartlingImportOptions({\n        projectId: this.projectId,\n        localeId: options.localeId,\n        fileUri: options.fileUri,\n        fileType: options.fileType,\n        content: options.content,\n        contentType: options.contentType,\n        overwrite: options.overwrite,\n        translationState: options.translationState\n      });\n\n      return this.authenticate()\n        .then(this._setAccessToken.bind(this))\n        .then(() => {\n          criteria.accessToken = this.accessToken;\n\n          return SmartlingImportService.send(criteria);\n        });\n    }\n\n    _setAccessToken(authenticateResponse) {\n      this.accessToken = authenticateResponse.accessToken;\n    }\n  }\n\n  return SmartlingClient;\n};\n"]}