## Getting started
This app is served by `microsite-profile`, so follow the monorepo root readme instructions for profile apps.
Instructions intended for Registry apps will not work.

## Testing & Mocks
Testing this app end-to-end locally or in PP requires:
- External user account to be created
- New agreement created and assigned to this user
- User logged into browser session

Some of this can be bypassed by loading from local mocks or PP mocks.

Your local dev server will always first try to serve a local mock if it is defined.
See `./mocks.json` and `./fixtures/YourMockNamesHere.json`

If local mocks do not exist, you locally running microsite-profile instance will proxy to PP apis.

In PP, if there is a route that is matched by the OT mock service, that will be served before hitting a real API.
These PP mocks can be found here: http://ot-mockserver-pp.otenv.com/services/46/

### Testing Example 1:
To load the first page of the agreement flow, with an agreement that requires scheduling, make sure the mock looks like:
```
  ...
  "agreementState": "agreementCreated",
  ...
  "data": {
    ...
    "schedulingLink": "https://calendly/link" // Note: this is not a valid calendly URL
    ...
  }
```
and then visit http://localhost:3000/admin/user-agreements/ee3f597e-9057-11e8-9eb6-529269fb1459/

### Testing Example 2:
To load the final page, with an agreement that skips the calendly step, make sure the mock looks like:
```
  ...
  "agreementState": "termsAccepted",
  ...
  "data": {
    ...
    "schedulingLink": "SKIP_SCHEDULING"
    ...
  }
```
and then visit http://localhost:3000/admin/user-agreements/ee3f597e-9057-11e8-9eb6-529269fb1459/
### Testing Example 3:
To load the final page, where you simulate just having finished the calendly scheduling, make sure the mock looks like:
```
  ...
  "agreementState": "termsAccepted",
  ...
  "data": {
    ...
    "schedulingLink": "https://calendly/link" // Note: this is not a valid calendly URL
    ...
  }
```
visit: http://localhost:3000/admin/user-agreements/ee3f597e-9057-11e8-9eb6-529269fb1459/agreement?utm_campaign=ee3f597e-9057-11e8-9eb6-529269fb1459&event_type_name=Test&event_start_time=2018-08-24T12:30:00-07:00

## Confirm Page Redirect/Refresh/Skip logic
![Confirm Page Logic](https://i.imgur.com/Z18qrPw.png)
[Edit Chart](https://www.lucidchart.com/invitations/accept/106b15b3-5dc1-465f-8fdb-1b26feca65b5)
