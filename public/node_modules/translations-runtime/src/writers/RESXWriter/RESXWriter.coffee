module.exports = (Writer, xmlParser, RESXConfig, RESXTemplate) ->

  class RESXWriter extends Writer

    fileName: -> "#{@locale}.resx"

    basePath: -> "resx"

    output: ->
      outputResx = RESXTemplate

      for key, value of @result
        itemTemplate = {
          "@":
            "name": key
            "xml:space": "preserve"
          "value": value
        }
        resxItem = xmlParser "data", itemTemplate, RESXConfig.itemConfig
        outputResx += "\n#{resxItem}"

      return "#{outputResx}\n</root>"
