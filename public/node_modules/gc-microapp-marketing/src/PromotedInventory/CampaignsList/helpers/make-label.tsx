import moment from 'moment';
import React from 'react';
import { InjectedIntl } from 'react-intl';
import { CustomSuppressionDate } from '../../../store/campaigns/campaigns.types';
import { dateFormat } from '../../constants';

const { MOMENT } = dateFormat;

const hasDefaultLabel = (label: string) => {
  return !label || /^(\d{4}-\d{2}-\d{2}( to )?){1,2}$/.test(label);
};

const makeLabel = (intl: InjectedIntl, item: any) => {
  const start = intl.formatDate(moment(item.startDate, MOMENT).toDate(), {
    day: 'numeric',
    month: 'short',
    year: 'numeric',
  });
  const end = item.endDate
    ? intl.formatDate(moment(item.endDate, MOMENT).toDate(), {
        day: 'numeric',
        month: 'short',
        year: 'numeric',
      })
    : '';
  let dateString: string;
  if (start === end || end === '') {
    dateString = `${start}`;
  } else {
    dateString = `${start} â€” ${end}`;
  }
  if (!hasDefaultLabel(item.label)) {
    return (
      <>
        {item.label}
        <span>{dateString}</span>
      </>
    );
  }
  return dateString;
};

export default makeLabel;
