import moment from 'moment';
import React from 'react';
import { IntlProvider } from 'react-intl';
import { create } from 'react-test-renderer';
import { keys } from '../../../translations/bundles/marketing.json';
import renderSuppressionDates from './render-suppression-dates';

describe('renderSuppressionDates', () => {
  const inFourDays = moment()
    .add(3, 'day')
    .toDate();
  const today = moment().toDate();

  const scenarios = [
    {
      description: 'thanksgiving_day_us',
      props: {
        defaultSuppressionDates: [
          {
            endDate: '2017-11-23',
            id: 'thanksgiving_day_us',
            label: 'Thanksgiving',
            startDate: '2017-11-23',
          },
        ],
        suppressionDates: {
          custom: [
            {
              endDate: inFourDays,
              label: 'a label',
              startDate: today,
            },
          ],
          default: ['thanksgiving_day_us'],
        },
      },
    },
    {
      description: 'suppressionDates null',
      props: {
        defaultSuppressionDates: [
          {
            endDate: '2017-11-23',
            id: 'thanksgiving_day_us',
            label: 'Thanksgiving',
            startDate: '2017-11-23',
          },
        ],
        suppressionDates: null,
      },
    },
  ];

  scenarios.map(({ description, props: { suppressionDates, defaultSuppressionDates } }) => {
    test(description, () => {
      const intlProvider = new IntlProvider({ locale: 'en' }, {});
      const intl = intlProvider.getChildContext().intl;
      const component = create(
        <IntlProvider locale="en-US" messages={keys}>
          <div>{renderSuppressionDates(intl, suppressionDates, defaultSuppressionDates)}</div>
        </IntlProvider>,
      );
      const tree = component.toJSON();
      expect(tree).toMatchSnapshot();
    });
  });
});
