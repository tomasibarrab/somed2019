import { Button, Panel } from 'gca-react-components';
import React, { SFC } from 'react';
import { FormattedMessage, InjectedIntlProps, injectIntl } from 'react-intl';
import { connect } from 'react-redux';
import { actions } from '../store/gifts/gifts';
import { GiftsPageType, ShowPagePayload } from '../store/gifts/gifts.types';
import { giftsEmail, LINK_TO_FAQ } from './constants';

import Champagne from '-!svg-react-loader?name=Champagne!./spot-icon-champagne.svg';

interface DP {
  showPage: (payload: ShowPagePayload) => void;
}

type Props = DP & InjectedIntlProps;

const GiftsFinished: SFC<Props> = ({ intl, showPage }) => (
  <Panel title={intl.formatMessage({ id: 'gifts.title' })}>
    <section className="gifts-finished">
      <Champagne />
      <FormattedMessage id="gifts.finished.title" tagName="h3" />
      <FormattedMessage id="gifts.finished.description.1" tagName="p" />
      <FormattedMessage
        id="gifts.finished.description.2"
        values={{
          'gifts-email': <a href={`mailto:${giftsEmail}`}>{giftsEmail}</a>,
          'our-faq-link': (
            <a href={LINK_TO_FAQ}>{intl.formatMessage({ id: 'gifts.finished.description.2.our_faq' })}</a>
          ),
        }}
        tagName="p"
      />
      <Button
        theme="primary"
        onClick={() => {
          showPage({ pageType: GiftsPageType.UrlEntryPage });
        }}
        className="ok-got-it"
        name="ok-got-it-from-finished"
        data-testid="ok-got-it-from-finished"
      >
        {intl.formatMessage({ id: 'gifts.finished.ok_got_it' })}
      </Button>
    </section>
  </Panel>
);

const mapDispatch = {
  showPage: actions.showPage,
};

export default connect<{}, DP, {}>(undefined, mapDispatch)(injectIntl(GiftsFinished));
