import React from 'react';
import { IntlProvider } from 'react-intl';
import { Provider } from 'react-redux';
import { create } from 'react-test-renderer';
import configureMockStore from 'redux-mock-store';
import messages from '../i18n/custom-promotions';
import makeCreditsModel from '../store/customPromotions/makeCreditsModel';
import CreateCustomPromotionTermsModal from './CreateCustomPromotionTermsModal';

describe('<CreateCustomPromotionTermsModal />', () => {
  // INFO: it looks like user info are not present in the snapshot
  const state = {
    currentContext: {
      restaurant: { name: 'Ye Olde Test Restaurant' },
      user: { firstName: 'John', lastName: 'Doe', userName: 'john.doe@email.com' },
    },
  };
  const store = configureMockStore([])(state);

  test('to match snapshot', () => {
    const props = {
      close: jest.fn(),
      confirm: jest.fn(),
      credits: makeCreditsModel({
        activeCustomPromotion: false,
        coverPrice: 2.75,
        creditAmount: 200,
        currencyCode: 'USD',
        rid: 123,
      }),
      formValuesSnapshot: {},
    };
    const component = create(
      <Provider store={store}>
        <IntlProvider locale="en-US" messages={messages}>
          <CreateCustomPromotionTermsModal {...props} />
        </IntlProvider>
      </Provider>,
    );
    const tree = component.toJSON();
    expect(tree).toMatchSnapshot();
  });
});
