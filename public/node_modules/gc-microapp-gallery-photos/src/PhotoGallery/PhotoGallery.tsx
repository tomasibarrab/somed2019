import { AlertMessage } from '@buffet/alert-message';
import { Button } from '@buffet/button';
import { Notify } from '@buffet/notify';
import { Panel } from 'gca-react-components';
import React, { useState } from 'react';
import { FormattedMessage, injectIntl } from 'react-intl';
import PhotoCollection from '../PhotoCollection/PhotoCollection';
import './PhotoGallery.scss';

interface Props {
  rid: number;
}

function PhotoGallery({ rid }: Props) {
  const [error, setError] = useState(null as null | Error);
  const handleError = (receivedError: Error) => {
    setError(receivedError);
  };

  return (
    <>
      <Notify autohide={false} delay={0} show={error !== null}>
        <AlertMessage
          id="error"
          iconId="negative"
          message={error ? error.message : ''}
          onClose={() => setError(null)}
          type="error"
        />
      </Notify>
      <section className="gallery-photos-container">
        <Panel
          headerContent={
            <div className="photo-tips">
              <Button className="photo-tips__action" onClick={e => e.preventDefault()} theme="link" type="button">
                <FormattedMessage id="galleryPhotos.photoTips.action" />
              </Button>
            </div>
          }
          title="Gallery photos"
        >
          <p className="panel-description">
            <FormattedMessage id="galleryPhotos.panelDescription" />
          </p>
          <PhotoCollection handleError={handleError} rid={rid} />
        </Panel>
        <p className="legal-message">
          <FormattedMessage id="galleryPhotos.legalMessage" />
        </p>
      </section>
    </>
  );
}

export default injectIntl(PhotoGallery);
